(function(){var t,e,s,n,o,i,r,l,a,p,h,f,c,u;s={rows:1,cols:1,transSpeed:500,index:0,data:[],controls:true,focusedClass:"focused",orientation:"horizontal",onChange:function(t){},onExit:function(t){},selectors:{container:"ul",wrapper:".wrapper",content:".content",focused:".focused",elem:"li",page:".page",tpl:'script[type="text/tpl"]'}};t={position:"relative",height:"100%"};u={overflow:"hidden",margin:0,padding:0};l={margin:0,padding:0,"float":"left"};o={"float":"left","list-style":"none"};a=function(t,e){var s,n;e=e||t.length;s=t.slice(0);n=[];while(s.length){n.push(s.splice(0,e))}return n};r=function(t){return typeof console!=="undefined"&&console!==null?console.log(t):void 0};n=function(t){return typeof console!=="undefined"&&console!==null?console.dir(t):void 0};f=function(t){t=t.replace("data-src","src");return function(e){var s,n,o,i;s="";for(o=0,i=e.length;o<i;o++){n=e[o];s+=t.replace(/\{(\w*)\}/g,function(t,e){return n[e]||t})}return s}};p=function(t,e){return t.querySelector(e)};h=function(t,e){var s,n,o,i,r;n=[];s=t.querySelectorAll(e);for(i=0,r=s.length;i<r;i++){o=s[i];if(o instanceof Element){n.push(o)}}return n};i=function(t){var e,s;s=getComputedStyle(t,null).getPropertyValue("margin-top");e=getComputedStyle(t,null).getPropertyValue("margin-bottom");return t.offsetHeight+parseFloat(s)+parseFloat(e)};c=function(t){var e,s;s=getComputedStyle(t,null).getPropertyValue("margin-right");e=getComputedStyle(t,null).getPropertyValue("margin-left");return t.offsetWidth+parseFloat(e)+parseFloat(s)};e=function(t,e){var s,n,o;n=[];if(t instanceof Element){for(s in e){o=e[s];n.push(""+s+": "+o)}t.setAttribute("style",n.join(";"))}return t};this.Gridy=function(){function n(t,e){var n,o,i,r,l,a,h,c,u,d,g,m,y=this;if(e==null){e={}}this.options={};for(i in s){h=s[i];this.options[i]=h}for(i in e){h=e[i];this.options[i]=h}this.el=p(document,t);if(!this.el){throw"DOM element with selector "+t+" is not found"}this.wrapper=p(this.el,this.options.selectors.wrapper);this.content=p(this.el,this.options.selectors.content);r=p(this.el,this.options.selectors.tpl);if(!this.options.tpl){this.options.tpl=f(r.innerHTML)}a="";m=["WebkitTransition","MozTransition","OTransition","MsTransition","transition"];for(c=0,d=m.length;c<d;c++){l=m[c];if(typeof document.body.style[l]==="string"){a=l}}if(!this.options.animate){this.options.animate=function(t,e,s){y.content.style[a]=""+s+"ms ease-in-out "+t;return y.content.style[t]=""+e+"px"}}if(this.options.data){this.insert(this.options.data)}if(e.controls){o=[];if(e.cols>1||e.rows===1){o.push("left");o.push("right")}if(e.rows>1){o.push("up");o.push("down")}for(u=0,g=o.length;u<g;u++){h=o[u];n=document.createElement("span");n.className=""+h+" control";n.innerHTML=h;n.direction=h;n.addEventListener("click",function(t){return y.move(t.currentTarget.direction)});this.el.appendChild(n)}}return this}n.prototype.insert=function(s){var n,r,p,f,d,g,m,y,w,v,b,x,T,C,L,S,E,k,A,M,z,F,H,P,V;if(s.length){y=this.options.cols*this.options.rows;w="";F=a(s,y);for(C=0,k=F.length;C<k;C++){T=F[C];w+='<ul class="page">'+this.options.tpl(T)+"</ul>"}if(w){this.content.innerHTML=w}this.elements=h(this.content,this.options.selectors.elem);this.pages=h(this.content,this.options.selectors.page);g=this.pages[0];d=this.elements[0];e(this.content,t);e(this.wrapper,u);if(this.elements){H=this.elements;for(L=0,A=H.length;L<A;L++){T=H[L];e(T,o)}}b=i(d);r=c(d);if(this.pages){P=this.pages;for(S=0,M=P.length;S<M;S++){T=P[S];e(T,l);T.style.height=""+b*this.options.rows+"px";T.style.width=""+r*this.options.cols+"px"}}this.wrapper.style.width=""+c(g)+"px";this.wrapper.style.height=""+i(g)+"px";if(this.options.orientation==="horizontal"){this.content.style.width=""+this.pages.length*c(g)+"px"}else{this.content.style.height=""+this.pages.length*i(g)+"px"}x={};p={};v=0;n=0;V=this.elements;for(E=0,z=V.length;E<z;E++){T=V[E];if(!x[T.offsetTop]){x[T.offsetTop]=[]}if(!p[T.offsetLeft]){p[T.offsetLeft]=[]}p[T.offsetLeft].push(T);x[T.offsetTop].push(T)}for(m in x){T=x[m];for(m in T){f=T[m];f.setAttribute("data-r",v)}v+=1}for(m in p){T=p[m];for(m in T){f=T[m];f.setAttribute("data-c",n)}n+=1}this.focus(this.elements[this.options.index],0)}return this};n.prototype.move=function(t){var e,s,n,o;s=p(this.content,this.options.selectors.focused);if(s){o=parseInt(s.getAttribute("data-r"));e=parseInt(s.getAttribute("data-c"));switch(t){case"left":e-=1;break;case"right":e+=1;break;case"up":o-=1;break;case"down":o+=1;break}n=p(this.content,"[data-r='"+o+"'][data-c='"+e+"']");if(n){n.classList.add(this.options.focusedClass);s.classList.remove(this.options.focusedClass);this.focus(n,this.options.transSpeed)}else{this.options.onExit(t)}}return this};n.prototype.focus=function(t,e){var s;if(e==null){e=0}t.classList.add(this.options.focusedClass);s=t.parentElement;if(this.options.orientation==="horizontal"){this.options.animate("left",-s.offsetLeft,e)}else{this.options.animate("top",-s.offsetTop,e)}this.options.onChange(t);return this};return n}()}).call(this)